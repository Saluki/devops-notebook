// Import the Express dependencies in our projects
const express = require('express');
const bodyParser = require('body-parser');
const rateLimit = require('express-rate-limit');

// Build a new HTTP web server using the Express package
const app = express();

app.use(bodyParser.json())
app.use(rateLimit.enforce());

// Receive HTTP GET requests on route / and print 'Hello world'
app.post('/', (req, res) => {

    if (req.body.username === 'admin' && req.body.password === 'password') {
        res.send(`\nWelcome to EvilCorp.\nYou are now logged in as ${req.body.username}\n\n`);
        return;
    }

    res.send(`\nAn intruder!\nYour credentials are incorrect...\n\n`);

});

// Start the HTTP server and listen for requests
app.listen(3000, () => {

    // Test a request on this server with
    // curl -H "Content-Type: application/json" --data '{"username":"admin","password":"password"}' -X POST localhost:3000

    console.log('VICTIM SERVER');
    console.log('-------------');
    console.log('This server will be hacked by a Node.js malware');
    console.log('Port 3000 is used by the Express server');
    console.log();

});

